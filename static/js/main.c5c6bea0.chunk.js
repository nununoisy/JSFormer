(this.webpackJsonpjsformer=this.webpackJsonpjsformer||[]).push([[0],{123:function(e,t){},125:function(e,t){},232:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(90),i=a.n(r),o=(a(99),a(6)),s=a(34),l=a(94),u=a.p+"static/media/upload.fe063de6.svg",h=a(0);function d(e){var t=e.onChange,a=c.a.useCallback((function(e){e&&e.length>0&&t&&t(window.URL.createObjectURL(e[0]))}),[t]),n=Object(l.a)({onDrop:a,accept:"image/*",maxFiles:1}),r=n.getRootProps,i=n.getInputProps,o=n.isDragActive;return Object(h.jsxs)("div",Object(s.a)(Object(s.a)({},r()),{},{className:"uploadContainer",children:[Object(h.jsx)("input",Object(s.a)({},i())),Object(h.jsxs)("div",{className:"uploadDisplayContainer",children:[Object(h.jsx)("img",{src:u}),o?Object(h.jsx)("p",{children:"Drop the image here!"}):Object(h.jsx)("p",{children:"Drag an image here or click to select..."})]})]}))}var b=a(11),j=a.n(b),p=a(23),g=a(32),m=a.n(g),O=a(92),x=a.n(O);function f(e,t,a){var n=new Uint32Array(e.buffer);a=a||t;var c=document.createElement("canvas"),r=document.createElement("canvas"),i=c.getContext("2d"),o=r.getContext("2d");c.width=t,c.height=Math.ceil(n.length/t),r.width=a,r.height=Math.ceil(c.height*a/t),i.imageSmoothingEnabled=i.mozImageSmoothingEnabled=i.webkitImageSmoothingEnabled=i.msImageSmoothingEnabled=!1,o.imageSmoothingEnabled=o.mozImageSmoothingEnabled=o.webkitImageSmoothingEnabled=o.msImageSmoothingEnabled=!1;var s,l=i.createImageData(c.width,c.height);if("CanvasPixelArray"==(s=l.data,Object.prototype.toString.call(s).slice(8,-1)))for(var u=l.data,h=0,d=u.length;h<d;++h)u[h]=e[h];else new Uint32Array(l.data.buffer).set(n);return i.putImageData(l,0,0),o.drawImage(c,0,0,r.width,r.height),r}function v(e){var t=e.imageURL,a=e.onChange,n=c.a.useState(!1),r=Object(o.a)(n,2),i=r[0],s=r[1],l=c.a.useState(8),u=Object(o.a)(l,2),d=u[0],b=u[1],g=c.a.useState(!1),O=Object(o.a)(g,2),v=O[0],S=O[1],w=c.a.useState("FloydSteinberg"),C=Object(o.a)(w,2),I=C[0],k=C[1],P=c.a.useState(16),N=Object(o.a)(P,2),M=N[0],_=N[1],y=c.a.useState(16),E=Object(o.a)(y,2),U=E[0],R=E[1],D=c.a.useState(null),B=Object(o.a)(D,2),F=B[0],L=B[1],A=c.a.useState(null),T=Object(o.a)(A,2),G=T[0],J=T[1],z=c.a.useRef(null);return c.a.useEffect(Object(p.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(!0),(n=new Image).onload=Object(p.a)(j.a.mark((function e(){var t,c,r,i,o,l,u,h,b,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z||!z.current){e.next=28;break}return(t=z.current).height=n.height,t.width=n.width,t.getContext("2d").drawImage(n,0,0),(c=new x.a({colors:Math.pow(2,d),dithKern:v?I:null,palette:1==d?[[0,0,0],[255,255,255]]:[],reIndex:!0})).sample(t),r=c.palette(),i=f(r,1==d?2:16,1==d?16:128),L(i.toDataURL()),o=c.reduce(n),l=f(o,n.width),e.next=15,m.a.read({url:l.toDataURL()});case 15:return u=e.sent,e.next=18,u.resize(U,M,m.a.RESIZE_NEAREST_NEIGHBOR);case 18:return h=e.sent,e.t0=J,e.next=22,h.getBase64Async(m.a.MIME_PNG);case 22:e.t1=e.sent,(0,e.t0)(e.t1),s(!1),b=[],p=[],h.scan(0,0,h.bitmap.width,h.bitmap.height,(function(e,t,n){var c=(h.bitmap.data[n]<<16|h.bitmap.data[n+1]<<8|h.bitmap.data[n+2])>>>0;b.includes(c)||b.push(c);var r=t*h.bitmap.width+e;switch(parseInt(d,10)){case 1:r%8===0?p.push(b.indexOf(c)<<7):p[p.length-1]|=b.indexOf(c)<<7-r%8;break;case 4:r%2===0?p.push(b.indexOf(c)<<4):p[p.length-1]|=b.indexOf(c);break;case 8:p.push(b.indexOf(c))}if(e==h.bitmap.width-1&&t==h.bitmap.height-1&&a){for(;b.length<Math.pow(2,d);)b.push(0);a({palette:b,imageData:p,w:U,h:M,colorDepth:d}),console.log(b,p)}}));case 28:case"end":return e.stop()}}),e)}))),n.src=t;case 4:case"end":return e.stop()}}),e)}))),[t,d,I,v,M,U]),Object(h.jsxs)("div",{className:"reformer",children:[Object(h.jsxs)("label",{children:["Image output size:",Object(h.jsx)("input",{type:"number",value:U,onChange:function(e){return R(parseInt(e.target.value,10))},className:"dimensionInput"}),"x",Object(h.jsx)("input",{type:"number",value:M,onChange:function(e){return _(parseInt(e.target.value,10))},className:"dimensionInput"})]}),Object(h.jsxs)("label",{children:["Color depth:",Object(h.jsxs)("select",{value:d,onChange:function(e){return b(e.target.value)},className:"bitdepthInput",children:[Object(h.jsx)("option",{value:1,children:"2 colors (1bpp)"}),Object(h.jsx)("option",{value:4,children:"16 colors (4bpp)"}),Object(h.jsx)("option",{value:8,children:"256 colors (8bpp)"})]})]}),Object(h.jsxs)("label",{children:[Object(h.jsx)("input",{type:"checkbox",checked:v,onChange:function(e){return S(e.target.checked)}}),"Use",Object(h.jsxs)("select",{value:I,onChange:function(e){return k(e.target.value)},disabled:!v,className:"dithKernSelect",children:[Object(h.jsx)("option",{value:"FloydSteinberg",children:"Floyd-Steinberg"}),Object(h.jsx)("option",{value:"FalseFloydSteinberg",children:"False Floyd-Steinberg"}),Object(h.jsx)("option",{value:"Stucki",children:"Stucki"}),Object(h.jsx)("option",{value:"Atkinson",children:"Atkinson"}),Object(h.jsx)("option",{value:"Jarvis",children:"Jarvis"}),Object(h.jsx)("option",{value:"Burkes",children:"Burkes"}),Object(h.jsx)("option",{value:"Sierra",children:"Sierra"}),Object(h.jsx)("option",{value:"TwoSierra",children:"2-row Sierra"}),Object(h.jsx)("option",{value:"SierraLite",children:"Sierra Lite"})]}),"dithering"]}),Object(h.jsx)("p",{children:"Input image:"}),Object(h.jsx)("div",{className:"inputCanvasContainer",children:Object(h.jsx)("canvas",{ref:z,children:Object(h.jsx)("p",{children:"Your browser needs to support HTML5 canvas to use this tool. Please upgrade or use a different browser."})})}),i?Object(h.jsx)("p",{children:"Rendering..."}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("p",{children:"Palette:"}),Object(h.jsx)("img",{src:F,className:"paletteImage"}),Object(h.jsx)("p",{children:"Reduced image (".concat(U,"x").concat(M,"@").concat(d,"bpp (").concat(Math.pow(2,d)," colors)):")}),Object(h.jsx)("a",{href:G,target:"_blank",title:"Open in new tab",children:Object(h.jsx)("img",{src:G,className:"outputImage"})})]})]})}var S=a(33),w=a.n(S),C=a(93),I=a.n(C);w.a.registerLanguage("c",I.a);var k=function(e,t,a){for(var n="    ",c=0;c<e.length;++c){var r=e[c];n+="0x"+Number(r).toString(16).padStart(t,"0")+",",(c+1)%a===0&&(n+="\n    ")}return n.replace(/\n {4}$/,"").replace(/,$/,"")};function P(e){var t=e.imageMetadata,a=c.a.useState("image"),n=Object(o.a)(a,2),r=n[0],i=n[1],s=c.a.useState("// Upload an image"),l=Object(o.a)(s,2),u=l[0],d=l[1],b=c.a.useState(w.a.highlight("// Upload an image",{language:"c"}).value),g=Object(o.a)(b,2),m=g[0],O=g[1],x=c.a.useState("knr"),f=Object(o.a)(x,2),v=f[0],S=f[1],C=c.a.useState(!1),I=Object(o.a)(C,2),P=I[0],N=I[1];return c.a.useEffect(Object(p.a)(j.a.mark((function e(){var a,n,c,i,o,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),null!==t){e.next=4;break}return d("// Upload an image"),e.abrupt("return");case 4:a=t.palette,n=t.imageData,c=t.w,i=t.h,o=t.colorDepth,s=["/** Generated with JSFormer","  * https://github.com/nununoisy/JSFormer","  *","  * Image name: ".concat(r),"  * ".concat(c,"x").concat(i,"@").concat(o,"bpp (").concat(Math.pow(2,o)," colors)"),"  */","","#include <ti/grlib/grlib.h>","// Change this include as needed if it doesn't work","","static const uint8_t pixel_".concat(r).concat(o,"BPP_UNCOMP[] =").concat("allman"===v?"\n":" ","{"),k(n,2,8),"};","","static const uint32_t palette_".concat(r).concat(o,"BPP_UNCOMP[] =").concat("allman"===v?"\n":" ","{"),k(a,6,4),"};","","const Graphics_Image ".concat(r).concat(o,"BPP_UNCOMP =").concat("allman"===v?"\n":" ","{"),"    IMAGE_FMT_".concat(o,"BPP_UNCOMP,"),"    ".concat(c,","),"    ".concat(i,","),"    ".concat(Math.pow(2,o),","),"    palette_".concat(r).concat(o,"BPP_UNCOMP,"),"    pixel_".concat(r).concat(o,"BPP_UNCOMP"),"};","","// extern const Graphics_Image ".concat(r).concat(o,"BPP_UNCOMP;"),"// Use the above line in the source file where you reference the image."].join("\n"),d(s),O(w.a.highlight(s,{language:"c"}).value);case 8:case"end":return e.stop()}}),e)}))),[t,r,v]),c.a.useEffect((function(){if(P){var e=setTimeout((function(){return N(!1)}),5e3);return function(){return clearTimeout(e)}}}),[P]),Object(h.jsxs)("div",{className:"codeGeneratorContainer",children:[Object(h.jsxs)("label",{children:["Prefix:",Object(h.jsx)("input",{type:"text",value:r,onChange:function(e){return i(e.target.value)}})]}),Object(h.jsxs)("label",{children:["Indentation style:",Object(h.jsxs)("select",{value:v,onChange:function(e){return S(e.target.value)},children:[Object(h.jsx)("option",{value:"knr",children:"K&R (brackets on same line)"}),Object(h.jsx)("option",{value:"allman",children:"Allman (brackets on next line)"})]})]}),Object(h.jsx)("button",{onClick:function(){navigator.clipboard.writeText(u).then((function(){return N(!0)})).catch((function(e){return console.log("Copy failed",e)}))},children:P?"Copied!":"Copy to clipboard"}),Object(h.jsx)("pre",{className:"hljs",children:Object(h.jsx)("code",{className:"language-c",dangerouslySetInnerHTML:{__html:m}})})]})}var N=function(){var e=c.a.useState(null),t=Object(o.a)(e,2),a=t[0],n=t[1],r=c.a.useState(null),i=Object(o.a)(r,2),s=i[0],l=i[1];return Object(h.jsxs)("div",{className:"columns",children:[Object(h.jsx)("div",{children:Object(h.jsx)(d,{onChange:function(e){return n(e)}})}),Object(h.jsx)("div",{children:Object(h.jsx)(v,{imageURL:a,onChange:function(e){return l(e)}})}),Object(h.jsx)("div",{children:Object(h.jsx)(P,{imageMetadata:s})})]})};i.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root"))},99:function(e,t,a){}},[[232,1,2]]]);
//# sourceMappingURL=main.c5c6bea0.chunk.js.map